{"remainingRequest":"F:\\workspace\\jf_front_end\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\workspace\\jf_front_end\\src\\views\\demo\\playground\\db\\page-user\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\workspace\\jf_front_end\\src\\views\\demo\\playground\\db\\page-user\\index.vue","mtime":1604992859715},{"path":"F:\\workspace\\jf_front_end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\workspace\\jf_front_end\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"F:\\workspace\\jf_front_end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\workspace\\jf_front_end\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyB1bmlxdWVJZCB9IGZyb20gJ2xvZGFzaCcNCmltcG9ydCB7IG1hcEFjdGlvbnMgfSBmcm9tICd2dWV4Jw0KZXhwb3J0IGRlZmF1bHQgew0KICBkYXRhICgpIHsNCiAgICByZXR1cm4gew0KICAgICAgZGF0YURpc3BsYXk6ICcnLA0KICAgICAga2V5TmFtZVRvU2V0OiAnJywNCiAgICAgIHZhbHVlVG9TZXQ6ICcnLA0KICAgICAga2V5TmFtZUxpc3Q6IFtdLA0KICAgICAga2V5TmFtZVRvRGVsZXRlOiAnJw0KICAgIH0NCiAgfSwNCiAgd2F0Y2g6IHsNCiAgICBrZXlOYW1lVG9EZWxldGUgKHZhbHVlKSB7DQogICAgICBpZiAodmFsdWUpIHsNCiAgICAgICAgdGhpcy5oYW5kbGVEZWxldGUodmFsdWUpDQogICAgICB9DQogICAgfQ0KICB9LA0KICBtb3VudGVkICgpIHsNCiAgICB0aGlzLmxvYWQoKQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgLi4ubWFwQWN0aW9ucygnZDJhZG1pbi9kYicsIFsNCiAgICAgICdkYXRhYmFzZVBhZ2UnLA0KICAgICAgJ2RhdGFiYXNlUGFnZUNsZWFyJw0KICAgIF0pLA0KICAgIC8qKg0KICAgICAqIOWKoOi9veacrOWcsOaVsOaNrg0KICAgICAqLw0KICAgIGFzeW5jIGxvYWQgKCkgew0KICAgICAgY29uc3QgZGIgPSBhd2FpdCB0aGlzLmRhdGFiYXNlUGFnZSh7DQogICAgICAgIHVzZXI6IHRydWUNCiAgICAgIH0pDQogICAgICB0aGlzLmRhdGFEaXNwbGF5ID0gSlNPTi5zdHJpbmdpZnkoZGIudmFsdWUoKSwgbnVsbCwgMikNCiAgICAgIHRoaXMua2V5TmFtZUxpc3QgPSBPYmplY3Qua2V5cyhkYi52YWx1ZSgpKS5tYXAoayA9PiAoew0KICAgICAgICB2YWx1ZTogaywNCiAgICAgICAgbGFiZWw6IGsNCiAgICAgIH0pKQ0KICAgIH0sDQogICAgLyoqDQogICAgICog5Yig6Zmk5LiA5Liq5a2X5q61DQogICAgICovDQogICAgYXN5bmMgaGFuZGxlRGVsZXRlIChuYW1lKSB7DQogICAgICBjb25zdCBkYiA9IGF3YWl0IHRoaXMuZGF0YWJhc2VQYWdlKHsNCiAgICAgICAgdXNlcjogdHJ1ZQ0KICAgICAgfSkNCiAgICAgIGRiDQogICAgICAgIC51bnNldChuYW1lKQ0KICAgICAgICAud3JpdGUoKQ0KICAgICAgdGhpcy5sb2FkKCkNCiAgICAgIHRoaXMua2V5TmFtZVRvRGVsZXRlID0gJycNCiAgICB9LA0KICAgIC8qKg0KICAgICAqIOa4heepuuW9k+WJjeeUqOaIt+eahOaVsOaNrg0KICAgICAqLw0KICAgIGFzeW5jIGhhbmRsZUNsZWFyICgpIHsNCiAgICAgIGF3YWl0IHRoaXMuZGF0YWJhc2VQYWdlQ2xlYXIoew0KICAgICAgICB1c2VyOiB0cnVlDQogICAgICB9KQ0KICAgICAgdGhpcy5sb2FkKCkNCiAgICB9LA0KICAgIC8qKg0KICAgICAqIOa3u+WKoOS4gOS4quaVsOaNrg0KICAgICAqLw0KICAgIGFzeW5jIGhhbmRsZVNldCAoKSB7DQogICAgICBpZiAodGhpcy5rZXlOYW1lVG9TZXQgPT09ICcnKSB7DQogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+Wtl+auteWQjeS4jeiDveS4uuepuicpDQogICAgICAgIHJldHVybg0KICAgICAgfQ0KICAgICAgY29uc3QgZGIgPSBhd2FpdCB0aGlzLmRhdGFiYXNlUGFnZSh7DQogICAgICAgIHVzZXI6IHRydWUNCiAgICAgIH0pDQogICAgICBkYg0KICAgICAgICAuc2V0KHRoaXMua2V5TmFtZVRvU2V0LCB0aGlzLnZhbHVlVG9TZXQpDQogICAgICAgIC53cml0ZSgpDQogICAgICB0aGlzLmxvYWQoKQ0KICAgIH0sDQogICAgLyoqDQogICAgICog5re75Yqg5LiA5Liq6ZqP5py65pWw5o2uDQogICAgICovDQogICAgYXN5bmMgaGFuZGxlU2V0UmFuZG9tICgpIHsNCiAgICAgIGNvbnN0IGlkID0gdW5pcXVlSWQoKQ0KICAgICAgY29uc3QgZGIgPSBhd2FpdCB0aGlzLmRhdGFiYXNlUGFnZSh7DQogICAgICAgIHVzZXI6IHRydWUNCiAgICAgIH0pDQogICAgICBkYg0KICAgICAgICAuc2V0KGB1bmlxdWVLZXkke2lkfWAsIGB2YWx1ZSR7aWR9YCkNCiAgICAgICAgLndyaXRlKCkNCiAgICAgIHRoaXMubG9hZCgpDQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/demo/playground/db/page-user","sourcesContent":["<template>\r\n  <d2-container>\r\n    <template slot=\"header\">\r\n      <el-alert\r\n        type=\"success\"\r\n        :closable=\"false\"\r\n        title=\"私有路由存储指当前路由的存储区域，\r\n          并且同时还根据用户区分，\r\n          相当于结合了 “路由存储” 和 “私有存储”，\r\n          不同路由以及不同用户之间存储不会相互干扰，\r\n          使用 await this.$store.dispatch('d2admin/db/databasePage', { user: true }) 获得存储实例进行操作，\r\n          不同路由和用户条件下获取的存储实例指向位置不同，\r\n          可以指定路由区分依据 name | path | fullPath，\r\n          默认根据路由的 name 区分不同的路由\"/>\r\n    </template>\r\n    <el-row>\r\n      <el-col :span=\"12\">\r\n        <p class=\"d2-mt-0\">增加不重复字段</p>\r\n        <el-button @click=\"handleSetRandom\">增加</el-button>\r\n        <p>增加自定义字段</p>\r\n        <el-input v-model=\"keyNameToSet\" placeholder=\"字段名\" class=\"d2-mr-5\" style=\"width: 100px;\"/>\r\n        <el-input v-model=\"valueToSet\" placeholder=\"值\" class=\"d2-mr-5\" style=\"width: 100px;\"/>\r\n        <el-button @click=\"handleSet\">增加</el-button>\r\n        <p>删除字段</p>\r\n        <el-select\r\n          v-model=\"keyNameToDelete\"\r\n          placeholder=\"请选择要删除的 key\">\r\n          <el-option\r\n            v-for=\"item in keyNameList\"\r\n            :key=\"item.value\"\r\n            :label=\"item.label\"\r\n            :value=\"item.value\">\r\n          </el-option>\r\n        </el-select>\r\n        <p>清空当前用户数据</p>\r\n        <el-button @click=\"handleClear\">清空</el-button>\r\n      </el-col>\r\n      <el-col :span=\"12\">\r\n        <d2-highlight :code=\"dataDisplay\"/>\r\n      </el-col>\r\n    </el-row>\r\n  </d2-container>\r\n</template>\r\n\r\n<script>\r\nimport { uniqueId } from 'lodash'\r\nimport { mapActions } from 'vuex'\r\nexport default {\r\n  data () {\r\n    return {\r\n      dataDisplay: '',\r\n      keyNameToSet: '',\r\n      valueToSet: '',\r\n      keyNameList: [],\r\n      keyNameToDelete: ''\r\n    }\r\n  },\r\n  watch: {\r\n    keyNameToDelete (value) {\r\n      if (value) {\r\n        this.handleDelete(value)\r\n      }\r\n    }\r\n  },\r\n  mounted () {\r\n    this.load()\r\n  },\r\n  methods: {\r\n    ...mapActions('d2admin/db', [\r\n      'databasePage',\r\n      'databasePageClear'\r\n    ]),\r\n    /**\r\n     * 加载本地数据\r\n     */\r\n    async load () {\r\n      const db = await this.databasePage({\r\n        user: true\r\n      })\r\n      this.dataDisplay = JSON.stringify(db.value(), null, 2)\r\n      this.keyNameList = Object.keys(db.value()).map(k => ({\r\n        value: k,\r\n        label: k\r\n      }))\r\n    },\r\n    /**\r\n     * 删除一个字段\r\n     */\r\n    async handleDelete (name) {\r\n      const db = await this.databasePage({\r\n        user: true\r\n      })\r\n      db\r\n        .unset(name)\r\n        .write()\r\n      this.load()\r\n      this.keyNameToDelete = ''\r\n    },\r\n    /**\r\n     * 清空当前用户的数据\r\n     */\r\n    async handleClear () {\r\n      await this.databasePageClear({\r\n        user: true\r\n      })\r\n      this.load()\r\n    },\r\n    /**\r\n     * 添加一个数据\r\n     */\r\n    async handleSet () {\r\n      if (this.keyNameToSet === '') {\r\n        this.$message.error('字段名不能为空')\r\n        return\r\n      }\r\n      const db = await this.databasePage({\r\n        user: true\r\n      })\r\n      db\r\n        .set(this.keyNameToSet, this.valueToSet)\r\n        .write()\r\n      this.load()\r\n    },\r\n    /**\r\n     * 添加一个随机数据\r\n     */\r\n    async handleSetRandom () {\r\n      const id = uniqueId()\r\n      const db = await this.databasePage({\r\n        user: true\r\n      })\r\n      db\r\n        .set(`uniqueKey${id}`, `value${id}`)\r\n        .write()\r\n      this.load()\r\n    }\r\n  }\r\n}\r\n</script>\r\n"]}]}