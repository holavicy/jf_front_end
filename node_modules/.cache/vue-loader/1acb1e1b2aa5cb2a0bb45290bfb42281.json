{"remainingRequest":"F:\\workspace\\jf_front_end\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\workspace\\jf_front_end\\src\\views\\demo\\plugins\\import\\xlsx.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\workspace\\jf_front_end\\src\\views\\demo\\plugins\\import\\xlsx.vue","mtime":1604992859741},{"path":"F:\\workspace\\jf_front_end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\workspace\\jf_front_end\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"F:\\workspace\\jf_front_end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\workspace\\jf_front_end\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgVnVlIGZyb20gJ3Z1ZScNCmltcG9ydCBwbHVnaW5JbXBvcnQgZnJvbSAnQGQyLXByb2plY3RzL3Z1ZS10YWJsZS1pbXBvcnQnDQpWdWUudXNlKHBsdWdpbkltcG9ydCkNCg0KZXhwb3J0IGRlZmF1bHQgew0KICBkYXRhICgpIHsNCiAgICByZXR1cm4gew0KICAgICAgdGFibGU6IHsNCiAgICAgICAgY29sdW1uczogW10sDQogICAgICAgIGRhdGE6IFtdLA0KICAgICAgICBzaXplOiAnbWluaScsDQogICAgICAgIHN0cmlwZTogdHJ1ZSwNCiAgICAgICAgYm9yZGVyOiB0cnVlDQogICAgICB9DQogICAgfQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgaGFuZGxlVXBsb2FkIChmaWxlKSB7DQogICAgICB0aGlzLiRpbXBvcnQueGxzeChmaWxlKQ0KICAgICAgICAudGhlbigoeyBoZWFkZXIsIHJlc3VsdHMgfSkgPT4gew0KICAgICAgICAgIHRoaXMudGFibGUuY29sdW1ucyA9IGhlYWRlci5tYXAoZSA9PiB7DQogICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICBsYWJlbDogZSwNCiAgICAgICAgICAgICAgcHJvcDogZQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0pDQogICAgICAgICAgdGhpcy50YWJsZS5kYXRhID0gcmVzdWx0cw0KICAgICAgICB9KQ0KICAgICAgcmV0dXJuIGZhbHNlDQogICAgfSwNCiAgICBkb3dubG9hZCAoKSB7DQogICAgICB0aGlzLiRvcGVuKCdodHRwczovL2Nkbi5kMi5wdWIvZmlsZXMvZDItYWRtaW4vZGVtby10YWJsZS54bHN4JykNCiAgICB9DQogIH0NCn0NCg=="},{"version":3,"sources":["xlsx.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4BA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"xlsx.vue","sourceRoot":"src/views/demo/plugins/import","sourcesContent":["<template>\r\n  <d2-container type=\"card\">\r\n    <template slot=\"header\">\r\n      <el-button @click=\"download\">\r\n        <d2-icon name=\"download\"/>\r\n        下载演示 .xlsx 表格\r\n      </el-button>\r\n    </template>\r\n    <div class=\"d2-mb\">\r\n      <el-upload :before-upload=\"handleUpload\" action=\"default\">\r\n        <el-button type=\"success\">\r\n          <d2-icon name=\"file-o\"/>\r\n          选择要导入的 .xlsx 表格\r\n        </el-button>\r\n      </el-upload>\r\n    </div>\r\n    <el-table v-bind=\"table\">\r\n      <el-table-column\r\n        v-for=\"(item, index) in table.columns\"\r\n        :key=\"index\"\r\n        :prop=\"item.prop\"\r\n        :label=\"item.label\">\r\n      </el-table-column>\r\n    </el-table>\r\n  </d2-container>\r\n</template>\r\n\r\n<script>\r\nimport Vue from 'vue'\r\nimport pluginImport from '@d2-projects/vue-table-import'\r\nVue.use(pluginImport)\r\n\r\nexport default {\r\n  data () {\r\n    return {\r\n      table: {\r\n        columns: [],\r\n        data: [],\r\n        size: 'mini',\r\n        stripe: true,\r\n        border: true\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    handleUpload (file) {\r\n      this.$import.xlsx(file)\r\n        .then(({ header, results }) => {\r\n          this.table.columns = header.map(e => {\r\n            return {\r\n              label: e,\r\n              prop: e\r\n            }\r\n          })\r\n          this.table.data = results\r\n        })\r\n      return false\r\n    },\r\n    download () {\r\n      this.$open('https://cdn.d2.pub/files/d2-admin/demo-table.xlsx')\r\n    }\r\n  }\r\n}\r\n</script>\r\n"]}]}