{"remainingRequest":"F:\\workspace\\jf_front_end\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\workspace\\jf_front_end\\src\\views\\demo\\business\\issues\\142\\edit-cache-db.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"F:\\workspace\\jf_front_end\\src\\views\\demo\\business\\issues\\142\\edit-cache-db.vue","mtime":1604992859545},{"path":"F:\\workspace\\jf_front_end\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\workspace\\jf_front_end\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"F:\\workspace\\jf_front_end\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"F:\\workspace\\jf_front_end\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\workspace\\jf_front_end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\workspace\\jf_front_end\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQoucGFnZSB7DQogIC5wYWdlLS1mb3JtIHsNCiAgICBtYXgtd2lkdGg6IDQ2MHB4Ow0KICB9DQp9DQo="},{"version":3,"sources":["edit-cache-db.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2FA;AACA;AACA;AACA;AACA","file":"edit-cache-db.vue","sourceRoot":"src/views/demo/business/issues/142","sourcesContent":["<template>\r\n  <d2-container\r\n    type=\"card\"\r\n    class=\"page\">\r\n    <el-form\r\n      ref=\"form\"\r\n      :model=\"form\"\r\n      label-width=\"80px\"\r\n      class=\"page--form\">\r\n      <el-form-item label=\"姓名\">\r\n        <el-input v-model=\"form.name\"/>\r\n      </el-form-item>\r\n      <el-form-item label=\"地址\">\r\n        <el-input type=\"textarea\" v-model=\"form.address\"/>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" @click=\"handleSubmit\">修改</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </d2-container>\r\n</template>\r\n\r\n<script>\r\nimport { mapActions } from 'vuex'\r\nimport base from './mixins/index'\r\nexport default {\r\n  mixins: [\r\n    base\r\n  ],\r\n  // 第一次进入或从其他组件对应路由进入时触发\r\n  beforeRouteEnter (to, from, next) {\r\n    const id = to.params.id\r\n    if (id) {\r\n      next(async instance => {\r\n        if (from.name === 'demo-business-issues-142') {\r\n          await instance.getFormData(id)\r\n          instance.saveDataToDb()\r\n        } else {\r\n          instance.loadDataFromDb(to)\r\n        }\r\n      })\r\n    }\r\n  },\r\n  // 在同一组件对应的多个路由间切换时触发\r\n  beforeRouteUpdate (to, from, next) {\r\n    const id = to.params.id\r\n    if (id) {\r\n      this.loadDataFromDb(to)\r\n      next()\r\n    }\r\n  },\r\n  watch: {\r\n    // 表单变化的时候更新持久化\r\n    form: {\r\n      handler () {\r\n        this.saveDataToDb()\r\n      },\r\n      deep: true\r\n    }\r\n  },\r\n  methods: {\r\n    ...mapActions('d2admin/db', [\r\n      'pageSet',\r\n      'pageGet'\r\n    ]),\r\n    // 将页面数据同步到持久化存储\r\n    saveDataToDb () {\r\n      this.pageSet({ instance: this, user: true })\r\n    },\r\n    // 从持久化存储恢复数据到页面\r\n    async loadDataFromDb (to) {\r\n      const instance = {\r\n        $route: {\r\n          fullPath: to.fullPath\r\n        },\r\n        $data: {}\r\n      }\r\n      const data = await this.pageGet({\r\n        instance,\r\n        user: true\r\n      })\r\n      for (const key in data) {\r\n        this[key] = data[key]\r\n      }\r\n      this.$message.success('loadDataFromDb')\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.page {\r\n  .page--form {\r\n    max-width: 460px;\r\n  }\r\n}\r\n</style>\r\n"]}]}