{"remainingRequest":"F:\\workspace\\jf_front_end\\node_modules\\babel-loader\\lib\\index.js!F:\\workspace\\jf_front_end\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\workspace\\jf_front_end\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\workspace\\jf_front_end\\src\\views\\demo\\business\\issues\\142\\edit-cache-db.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\workspace\\jf_front_end\\src\\views\\demo\\business\\issues\\142\\edit-cache-db.vue","mtime":1604992859545},{"path":"F:\\workspace\\jf_front_end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\workspace\\jf_front_end\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"F:\\workspace\\jf_front_end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\workspace\\jf_front_end\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZSI7CmltcG9ydCBfb2JqZWN0U3ByZWFkIGZyb20gIkY6L3dvcmtzcGFjZS9qZl9mcm9udF9lbmQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZSI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICJGOi93b3Jrc3BhY2UvamZfZnJvbnRfZW5kL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHsgbWFwQWN0aW9ucyB9IGZyb20gJ3Z1ZXgnOwppbXBvcnQgYmFzZSBmcm9tICcuL21peGlucy9pbmRleCc7CmV4cG9ydCBkZWZhdWx0IHsKICBtaXhpbnM6IFtiYXNlXSwKICAvLyDnrKzkuIDmrKHov5vlhaXmiJbku47lhbbku5bnu4Tku7blr7nlupTot6/nlLHov5vlhaXml7bop6blj5EKICBiZWZvcmVSb3V0ZUVudGVyOiBmdW5jdGlvbiBiZWZvcmVSb3V0ZUVudGVyKHRvLCBmcm9tLCBuZXh0KSB7CiAgICB2YXIgaWQgPSB0by5wYXJhbXMuaWQ7CgogICAgaWYgKGlkKSB7CiAgICAgIG5leHQoIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIF9yZWYgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoaW5zdGFuY2UpIHsKICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgaWYgKCEoZnJvbS5uYW1lID09PSAnZGVtby1idXNpbmVzcy1pc3N1ZXMtMTQyJykpIHsKICAgICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNjsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDM7CiAgICAgICAgICAgICAgICAgIHJldHVybiBpbnN0YW5jZS5nZXRGb3JtRGF0YShpZCk7CgogICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICBpbnN0YW5jZS5zYXZlRGF0YVRvRGIoKTsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDc7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICAgICAgaW5zdGFuY2UubG9hZERhdGFGcm9tRGIodG8pOwoKICAgICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9LCBfY2FsbGVlKTsKICAgICAgICB9KSk7CgogICAgICAgIHJldHVybiBmdW5jdGlvbiAoX3gpIHsKICAgICAgICAgIHJldHVybiBfcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgfTsKICAgICAgfSgpKTsKICAgIH0KICB9LAogIC8vIOWcqOWQjOS4gOe7hOS7tuWvueW6lOeahOWkmuS4qui3r+eUsemXtOWIh+aNouaXtuinpuWPkQogIGJlZm9yZVJvdXRlVXBkYXRlOiBmdW5jdGlvbiBiZWZvcmVSb3V0ZVVwZGF0ZSh0bywgZnJvbSwgbmV4dCkgewogICAgdmFyIGlkID0gdG8ucGFyYW1zLmlkOwoKICAgIGlmIChpZCkgewogICAgICB0aGlzLmxvYWREYXRhRnJvbURiKHRvKTsKICAgICAgbmV4dCgpOwogICAgfQogIH0sCiAgd2F0Y2g6IHsKICAgIC8vIOihqOWNleWPmOWMlueahOaXtuWAmeabtOaWsOaMgeS5heWMlgogICAgZm9ybTogewogICAgICBoYW5kbGVyOiBmdW5jdGlvbiBoYW5kbGVyKCkgewogICAgICAgIHRoaXMuc2F2ZURhdGFUb0RiKCk7CiAgICAgIH0sCiAgICAgIGRlZXA6IHRydWUKICAgIH0KICB9LAogIG1ldGhvZHM6IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgbWFwQWN0aW9ucygnZDJhZG1pbi9kYicsIFsncGFnZVNldCcsICdwYWdlR2V0J10pKSwge30sIHsKICAgIC8vIOWwhumhtemdouaVsOaNruWQjOatpeWIsOaMgeS5heWMluWtmOWCqAogICAgc2F2ZURhdGFUb0RiOiBmdW5jdGlvbiBzYXZlRGF0YVRvRGIoKSB7CiAgICAgIHRoaXMucGFnZVNldCh7CiAgICAgICAgaW5zdGFuY2U6IHRoaXMsCiAgICAgICAgdXNlcjogdHJ1ZQogICAgICB9KTsKICAgIH0sCiAgICAvLyDku47mjIHkuYXljJblrZjlgqjmgaLlpI3mlbDmja7liLDpobXpnaIKICAgIGxvYWREYXRhRnJvbURiOiBmdW5jdGlvbiBsb2FkRGF0YUZyb21EYih0bykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICAgICAgdmFyIGluc3RhbmNlLCBkYXRhLCBrZXk7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGluc3RhbmNlID0gewogICAgICAgICAgICAgICAgICAkcm91dGU6IHsKICAgICAgICAgICAgICAgICAgICBmdWxsUGF0aDogdG8uZnVsbFBhdGgKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgJGRhdGE6IHt9CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnBhZ2VHZXQoewogICAgICAgICAgICAgICAgICBpbnN0YW5jZTogaW5zdGFuY2UsCiAgICAgICAgICAgICAgICAgIHVzZXI6IHRydWUKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBkYXRhID0gX2NvbnRleHQyLnNlbnQ7CgogICAgICAgICAgICAgICAgZm9yIChrZXkgaW4gZGF0YSkgewogICAgICAgICAgICAgICAgICBfdGhpc1trZXldID0gZGF0YVtrZXldOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ2xvYWREYXRhRnJvbURiJyk7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMik7CiAgICAgIH0pKSgpOwogICAgfQogIH0pCn07"},{"version":3,"sources":["edit-cache-db.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAuBA,SAAA,UAAA,QAAA,MAAA;AACA,OAAA,IAAA,MAAA,gBAAA;AACA,eAAA;AACA,EAAA,MAAA,EAAA,CACA,IADA,CADA;AAIA;AACA,EAAA,gBALA,4BAKA,EALA,EAKA,IALA,EAKA,IALA,EAKA;AACA,QAAA,EAAA,GAAA,EAAA,CAAA,MAAA,CAAA,EAAA;;AACA,QAAA,EAAA,EAAA;AACA,MAAA,IAAA;AAAA,2EAAA,iBAAA,QAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBACA,IAAA,CAAA,IAAA,KAAA,0BADA;AAAA;AAAA;AAAA;;AAAA;AAAA,yBAEA,QAAA,CAAA,WAAA,CAAA,EAAA,CAFA;;AAAA;AAGA,kBAAA,QAAA,CAAA,YAAA;AAHA;AAAA;;AAAA;AAKA,kBAAA,QAAA,CAAA,cAAA,CAAA,EAAA;;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAA;;AAAA;AAAA;AAAA;AAAA,UAAA;AAQA;AACA,GAjBA;AAkBA;AACA,EAAA,iBAnBA,6BAmBA,EAnBA,EAmBA,IAnBA,EAmBA,IAnBA,EAmBA;AACA,QAAA,EAAA,GAAA,EAAA,CAAA,MAAA,CAAA,EAAA;;AACA,QAAA,EAAA,EAAA;AACA,WAAA,cAAA,CAAA,EAAA;AACA,MAAA,IAAA;AACA;AACA,GAzBA;AA0BA,EAAA,KAAA,EAAA;AACA;AACA,IAAA,IAAA,EAAA;AACA,MAAA,OADA,qBACA;AACA,aAAA,YAAA;AACA,OAHA;AAIA,MAAA,IAAA,EAAA;AAJA;AAFA,GA1BA;AAmCA,EAAA,OAAA,kCACA,UAAA,CAAA,YAAA,EAAA,CACA,SADA,EAEA,SAFA,CAAA,CADA;AAKA;AACA,IAAA,YANA,0BAMA;AACA,WAAA,OAAA,CAAA;AAAA,QAAA,QAAA,EAAA,IAAA;AAAA,QAAA,IAAA,EAAA;AAAA,OAAA;AACA,KARA;AASA;AACA,IAAA,cAVA,0BAUA,EAVA,EAUA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,gBAAA,QADA,GACA;AACA,kBAAA,MAAA,EAAA;AACA,oBAAA,QAAA,EAAA,EAAA,CAAA;AADA,mBADA;AAIA,kBAAA,KAAA,EAAA;AAJA,iBADA;AAAA;AAAA,uBAOA,KAAA,CAAA,OAAA,CAAA;AACA,kBAAA,QAAA,EAAA,QADA;AAEA,kBAAA,IAAA,EAAA;AAFA,iBAAA,CAPA;;AAAA;AAOA,gBAAA,IAPA;;AAWA,qBAAA,GAAA,IAAA,IAAA,EAAA;AACA,kBAAA,KAAA,CAAA,GAAA,CAAA,GAAA,IAAA,CAAA,GAAA,CAAA;AACA;;AACA,gBAAA,KAAA,CAAA,QAAA,CAAA,OAAA,CAAA,gBAAA;;AAdA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAeA;AAzBA;AAnCA,CAAA","sourcesContent":["<template>\r\n  <d2-container\r\n    type=\"card\"\r\n    class=\"page\">\r\n    <el-form\r\n      ref=\"form\"\r\n      :model=\"form\"\r\n      label-width=\"80px\"\r\n      class=\"page--form\">\r\n      <el-form-item label=\"姓名\">\r\n        <el-input v-model=\"form.name\"/>\r\n      </el-form-item>\r\n      <el-form-item label=\"地址\">\r\n        <el-input type=\"textarea\" v-model=\"form.address\"/>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" @click=\"handleSubmit\">修改</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </d2-container>\r\n</template>\r\n\r\n<script>\r\nimport { mapActions } from 'vuex'\r\nimport base from './mixins/index'\r\nexport default {\r\n  mixins: [\r\n    base\r\n  ],\r\n  // 第一次进入或从其他组件对应路由进入时触发\r\n  beforeRouteEnter (to, from, next) {\r\n    const id = to.params.id\r\n    if (id) {\r\n      next(async instance => {\r\n        if (from.name === 'demo-business-issues-142') {\r\n          await instance.getFormData(id)\r\n          instance.saveDataToDb()\r\n        } else {\r\n          instance.loadDataFromDb(to)\r\n        }\r\n      })\r\n    }\r\n  },\r\n  // 在同一组件对应的多个路由间切换时触发\r\n  beforeRouteUpdate (to, from, next) {\r\n    const id = to.params.id\r\n    if (id) {\r\n      this.loadDataFromDb(to)\r\n      next()\r\n    }\r\n  },\r\n  watch: {\r\n    // 表单变化的时候更新持久化\r\n    form: {\r\n      handler () {\r\n        this.saveDataToDb()\r\n      },\r\n      deep: true\r\n    }\r\n  },\r\n  methods: {\r\n    ...mapActions('d2admin/db', [\r\n      'pageSet',\r\n      'pageGet'\r\n    ]),\r\n    // 将页面数据同步到持久化存储\r\n    saveDataToDb () {\r\n      this.pageSet({ instance: this, user: true })\r\n    },\r\n    // 从持久化存储恢复数据到页面\r\n    async loadDataFromDb (to) {\r\n      const instance = {\r\n        $route: {\r\n          fullPath: to.fullPath\r\n        },\r\n        $data: {}\r\n      }\r\n      const data = await this.pageGet({\r\n        instance,\r\n        user: true\r\n      })\r\n      for (const key in data) {\r\n        this[key] = data[key]\r\n      }\r\n      this.$message.success('loadDataFromDb')\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.page {\r\n  .page--form {\r\n    max-width: 460px;\r\n  }\r\n}\r\n</style>\r\n"],"sourceRoot":"src/views/demo/business/issues/142"}]}